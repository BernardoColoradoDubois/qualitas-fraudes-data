MERGE INTO INSUMOS.DM_VALE tgt
USING RAW_INSUMOS.STG_VALE stg
ON (tgt.IDVALE = stg.IDVALE)
WHEN MATCHED THEN
  UPDATE SET
    tgt.IDEXPEDIENTE = stg.IDEXPEDIENTE,
    tgt.CODPROVEEDOR = stg.CODPROVEEDOR,
    tgt.MONTO = stg.MONTO,
    tgt.FOLIO = stg.FOLIO,
    tgt.FECHAEXPEDICION = stg.FECHAEXPEDICION,
    tgt.FECHAACTUALIZACION = stg.FECHAACTUALIZACION,
    tgt.IDVALEESTATUS = stg.IDVALEESTATUS,
    tgt.VALE = stg.VALE,
    tgt.LEIDOORDEN = stg.LEIDOORDEN,
    tgt.LEIDOVALE = stg.LEIDOVALE,
    tgt.PIEZASRECIBIDAS = stg.PIEZASRECIBIDAS,
    tgt.AUTORIZADOR = stg.AUTORIZADOR,
    tgt.COTIZADOR = stg.COTIZADOR,
    tgt.TOTALDESRESCATEPT = stg.TOTALDESRESCATEPT,
    tgt.ESTATUSVALESISE = stg.ESTATUSVALESISE,
    tgt.MONTOPAGADOSISE = stg.MONTOPAGADOSISE,
    tgt.FECHAPAGOSISE = stg.FECHAPAGOSISE,
    tgt.PENDIENTELIBERAR = stg.PENDIENTELIBERAR,
    tgt.DEVUELTO = stg.DEVUELTO,
    tgt.ESTATUSACTUALSISE = stg.ESTATUSACTUALSISE
WHEN NOT MATCHED THEN
  INSERT (
    IDVALE,
    IDEXPEDIENTE,
    CODPROVEEDOR,
    MONTO,
    FOLIO,
    FECHAEXPEDICION,
    FECHAACTUALIZACION,
    IDVALEESTATUS,
    VALE,
    LEIDOORDEN,
    LEIDOVALE,
    PIEZASRECIBIDAS,
    AUTORIZADOR,
    COTIZADOR,
    TOTALDESRESCATEPT,
    ESTATUSVALESISE,
    MONTOPAGADOSISE,
    FECHAPAGOSISE,
    PENDIENTELIBERAR,
    DEVUELTO,
    ESTATUSACTUALSISE
  )
  VALUES (
    stg.IDVALE,
    stg.IDEXPEDIENTE,
    stg.CODPROVEEDOR,
    stg.MONTO,
    stg.FOLIO,
    stg.FECHAEXPEDICION,
    stg.FECHAACTUALIZACION,
    stg.IDVALEESTATUS,
    stg.VALE,
    stg.LEIDOORDEN,
    stg.LEIDOVALE,
    stg.PIEZASRECIBIDAS,
    stg.AUTORIZADOR,
    stg.COTIZADOR,
    stg.TOTALDESRESCATEPT,
    stg.ESTATUSVALESISE,
    stg.MONTOPAGADOSISE,
    stg.FECHAPAGOSISE,
    stg.PENDIENTELIBERAR,
    stg.DEVUELTO,
    stg.ESTATUSACTUALSISE
  );