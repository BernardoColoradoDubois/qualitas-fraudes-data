MERGE INTO INSUMOS.DM_FECHAS tgt
USING RAW_INSUMOS.STG_FECHAS stg
ON (tgt.IDFECHAS = stg.IDFECHAS)
WHEN MATCHED THEN
  UPDATE SET
    tgt.IDEXPEDIENTE = stg.IDEXPEDIENTE,
    tgt.FECASIGNACION = stg.FECASIGNACION,
    tgt.FECADJUDICACION = stg.FECADJUDICACION,
    tgt.FECINGRESO = stg.FECINGRESO,
    tgt.FECVALUACION = stg.FECVALUACION,
    tgt.FECTERMINADO = stg.FECTERMINADO,
    tgt.FECENTREGADO = stg.FECENTREGADO,
    tgt.FECREGISTRO = stg.FECREGISTRO,
    tgt.FECENVIO = stg.FECENVIO,
    tgt.DIASREPARACION = stg.DIASREPARACION,
    tgt.FECASIGNACIONVAL = stg.FECASIGNACIONVAL,
    tgt.FECAUTORIZACION = stg.FECAUTORIZACION,
    tgt.FECSINIESTRO = stg.FECSINIESTRO,
    tgt.FECPROMESA = stg.FECPROMESA,
    tgt.FECREFACCIONESENTREGADAS = stg.FECREFACCIONESENTREGADAS,
    tgt.FECREGISTROLLAVECRM = stg.FECREGISTROLLAVECRM,
    tgt.FECACTUALIZACIONLLAVECRM = stg.FECACTUALIZACIONLLAVECRM,
    tgt.FECREGISTROPAGOANTICIPADO = stg.FECREGISTROPAGOANTICIPADO,
    tgt.FECENVIOCARRUSELA8 = stg.FECENVIOCARRUSELA8,
    tgt.FECENVIOCARRUSELBLINDAJE = stg.FECENVIOCARRUSELBLINDAJE,
    tgt.FECPRIMERENVIOHERRAMIENTA = stg.FECPRIMERENVIOHERRAMIENTA,
    tgt.FECHAENVIOPT = stg.FECHAENVIOPT,
    tgt.FECHAPROGPT = stg.FECHAPROGPT,
    tgt.FECMARCADOUSUARIO = stg.FECMARCADOUSUARIO,
    tgt.FECADJUDICACCQ = stg.FECADJUDICACCQ,
    tgt.PROMESA_ENVIO_CRM = stg.PROMESA_ENVIO_CRM,
    tgt.FECHAFINIQUITO = stg.FECHAFINIQUITO,
    tgt.INGRESO_CLIENTE = stg.INGRESO_CLIENTE,
    tgt.FECLIBCHATARRA = stg.FECLIBCHATARRA,
    tgt.FECHAOCURRIDOSISE = stg.FECHAOCURRIDOSISE,
    tgt.AUT_UNA_PZA_CM = stg.AUT_UNA_PZA_CM,
    tgt.FECHAESTENT = stg.FECHAESTENT,
    tgt.SEMANAESTENT = stg.SEMANAESTENT,
    tgt.ESTIMADAENVIOCRM = stg.ESTIMADAENVIOCRM
WHEN NOT MATCHED THEN
  INSERT (
    IDFECHAS,
    IDEXPEDIENTE,
    FECASIGNACION,
    FECADJUDICACION,
    FECINGRESO,
    FECVALUACION,
    FECTERMINADO,
    FECENTREGADO,
    FECREGISTRO,
    FECENVIO,
    DIASREPARACION,
    FECASIGNACIONVAL,
    FECAUTORIZACION,
    FECSINIESTRO,
    FECPROMESA,
    FECREFACCIONESENTREGADAS,
    FECREGISTROLLAVECRM,
    FECACTUALIZACIONLLAVECRM,
    FECREGISTROPAGOANTICIPADO,
    FECENVIOCARRUSELA8,
    FECENVIOCARRUSELBLINDAJE,
    FECPRIMERENVIOHERRAMIENTA,
    FECHAENVIOPT,
    FECHAPROGPT,
    FECMARCADOUSUARIO,
    FECADJUDICACCQ,
    PROMESA_ENVIO_CRM,
    FECHAFINIQUITO,
    INGRESO_CLIENTE,
    FECLIBCHATARRA,
    FECHAOCURRIDOSISE,
    AUT_UNA_PZA_CM,
    FECHAESTENT,
    SEMANAESTENT,
    ESTIMADAENVIOCRM
  )
  VALUES (
    stg.IDFECHAS,
    stg.IDEXPEDIENTE,
    stg.FECASIGNACION,
    stg.FECADJUDICACION,
    stg.FECINGRESO,
    stg.FECVALUACION,
    stg.FECTERMINADO,
    stg.FECENTREGADO,
    stg.FECREGISTRO,
    stg.FECENVIO,
    stg.DIASREPARACION,
    stg.FECASIGNACIONVAL,
    stg.FECAUTORIZACION,
    stg.FECSINIESTRO,
    stg.FECPROMESA,
    stg.FECREFACCIONESENTREGADAS,
    stg.FECREGISTROLLAVECRM,
    stg.FECACTUALIZACIONLLAVECRM,
    stg.FECREGISTROPAGOANTICIPADO,
    stg.FECENVIOCARRUSELA8,
    stg.FECENVIOCARRUSELBLINDAJE,
    stg.FECPRIMERENVIOHERRAMIENTA,
    stg.FECHAENVIOPT,
    stg.FECHAPROGPT,
    stg.FECMARCADOUSUARIO,
    stg.FECADJUDICACCQ,
    stg.PROMESA_ENVIO_CRM,
    stg.FECHAFINIQUITO,
    stg.INGRESO_CLIENTE,
    stg.FECLIBCHATARRA,
    stg.FECHAOCURRIDOSISE,
    stg.AUT_UNA_PZA_CM,
    stg.FECHAESTENT,
    stg.SEMANAESTENT,
    stg.ESTIMADAENVIOCRM
  )