MERGE INTO INSUMOS.DM_PROVEEDOR tgt
USING RAW_INSUMOS.STG_PROVEEDOR stg
ON (tgt.CODPROVEEDOR = stg.CODPROVEEDOR)
WHEN MATCHED THEN
  UPDATE SET
    tgt.NOMBRE = stg.NOMBRE,
    tgt.ALTA = stg.ALTA,
    tgt.ACTUALIZACION = stg.ACTUALIZACION,
    tgt.USUARIOACTUALIZA = stg.USUARIOACTUALIZA,
    tgt.IDREGION = stg.IDREGION,
    tgt.MAIL = stg.MAIL,
    tgt.DATO = stg.DATO,
    tgt.TIPO = stg.TIPO,
    tgt.MULTIMARCA = stg.MULTIMARCA,
    tgt.IDTIPOTOT = stg.IDTIPOTOT,
    tgt.IDIVA = stg.IDIVA,
    tgt.CELULARNEXTEL = stg.CELULARNEXTEL,
    tgt.NUMTELEFONICO = stg.NUMTELEFONICO,
    tgt.ASIGNACIONVALUADOR = stg.ASIGNACIONVALUADOR,
    tgt.PORCENTAJEDESCUENTOADICIONAL = stg.PORCENTAJEDESCUENTOADICIONAL,
    tgt.COSTOFIJO = stg.COSTOFIJO,
    tgt.FECHAACEPTACIONPOLITICA = stg.FECHAACEPTACIONPOLITICA,
    tgt.FIRMA = stg.FIRMA,
    tgt.ESTATUSPROVEEDOR = stg.ESTATUSPROVEEDOR,
    tgt.RFC = stg.RFC,
    tgt.USUARIOALTA = stg.USUARIOALTA,
    tgt.RECCHATARRA = stg.RECCHATARRA,
    tgt.FECACEPTAETICACONDUCTAPROV = stg.FECACEPTAETICACONDUCTAPROV,
    tgt.FECACEPTACONFLICTOPROV = stg.FECACEPTACONFLICTOPROV,
    tgt.VIP = stg.VIP,
    tgt.VERINDICADORES = stg.VERINDICADORES,
    tgt.SUSPAUTO = stg.SUSPAUTO,
    tgt.NOMOSTRARMONTOENVALES = stg.NOMOSTRARMONTOENVALES,
    tgt.LIBERADO = stg.LIBERADO,
    tgt.MAIL2 = stg.MAIL2,
    tgt.FECACEPTAAVISOPRIV = stg.FECACEPTAAVISOPRIV,
    tgt.CONFIANZA = stg.CONFIANZA,
    tgt.ACTUALIZACIONCONFIANZA = stg.ACTUALIZACIONCONFIANZA,
    tgt.ASIGNACIONINACTIVA = stg.ASIGNACIONINACTIVA
WHEN NOT MATCHED THEN
  INSERT (
    CODPROVEEDOR,
    NOMBRE,
    ALTA,
    ACTUALIZACION,
    USUARIOACTUALIZA,
    IDREGION,
    MAIL,
    DATO,
    TIPO,
    MULTIMARCA,
    IDTIPOTOT,
    IDIVA,
    CELULARNEXTEL,
    NUMTELEFONICO,
    ASIGNACIONVALUADOR,
    PORCENTAJEDESCUENTOADICIONAL,
    COSTOFIJO,
    FECHAACEPTACIONPOLITICA,
    FIRMA,
    ESTATUSPROVEEDOR,
    RFC,
    USUARIOALTA,
    RECCHATARRA,
    FECACEPTAETICACONDUCTAPROV,
    FECACEPTACONFLICTOPROV,
    VIP,
    VERINDICADORES,
    SUSPAUTO,
    NOMOSTRARMONTOENVALES,
    LIBERADO,
    MAIL2,
    FECACEPTAAVISOPRIV,
    CONFIANZA,
    ACTUALIZACIONCONFIANZA,
    ASIGNACIONINACTIVA
  )
  VALUES (
    stg.CODPROVEEDOR,
    stg.NOMBRE,
    stg.ALTA,
    stg.ACTUALIZACION,
    stg.USUARIOACTUALIZA,
    stg.IDREGION,
    stg.MAIL,
    stg.DATO,
    stg.TIPO,
    stg.MULTIMARCA,
    stg.IDTIPOTOT,
    stg.IDIVA,
    stg.CELULARNEXTEL,
    stg.NUMTELEFONICO,
    stg.ASIGNACIONVALUADOR,
    stg.PORCENTAJEDESCUENTOADICIONAL,
    stg.COSTOFIJO,
    stg.FECHAACEPTACIONPOLITICA,
    stg.FIRMA,
    stg.ESTATUSPROVEEDOR,
    stg.RFC,
    stg.USUARIOALTA,
    stg.RECCHATARRA,
    stg.FECACEPTAETICACONDUCTAPROV,
    stg.FECACEPTACONFLICTOPROV,
    stg.VIP,
    stg.VERINDICADORES,
    stg.SUSPAUTO,
    stg.NOMOSTRARMONTOENVALES,
    stg.LIBERADO,
    stg.MAIL2,
    stg.FECACEPTAAVISOPRIV,
    stg.CONFIANZA,
    stg.ACTUALIZACIONCONFIANZA,
    stg.ASIGNACIONINACTIVA
  )