MERGE INTO INSUMOS.DM_TALLERES tgt
USING RAW_INSUMOS.STG_TALLERES stg
ON (tgt.IDTALLER = stg.IDTALLER)
WHEN MATCHED THEN
  UPDATE SET
    tgt.IDOFICINA = stg.IDOFICINA,
    tgt.CLAVETALLER = stg.CLAVETALLER,
    tgt.RAZONSOCIAL = stg.RAZONSOCIAL,
    tgt.NOMBRECOMERCIAL = stg.NOMBRECOMERCIAL,
    tgt.CONTRIBUYENTE = stg.CONTRIBUYENTE,
    tgt.REPRESENTANTELEGAL = stg.REPRESENTANTELEGAL,
    tgt.CORREO = stg.CORREO,
    tgt.RFC = stg.RFC,
    tgt.DOMICILIOFISCAL = stg.DOMICILIOFISCAL,
    tgt.DIRECCIONCOMERCIAL = stg.DIRECCIONCOMERCIAL,
    tgt.CELULARNEXTEL = stg.CELULARNEXTEL,
    tgt.TARIFAMOB = stg.TARIFAMOB,
    tgt.ENTIDAD = stg.ENTIDAD,
    tgt.PERFIL = stg.PERFIL,
    tgt.COTIZADOR = stg.COTIZADOR,
    tgt.MITCHELL = stg.MITCHELL,
    tgt.TIPO = stg.TIPO,
    tgt.MULTIMARCA = stg.MULTIMARCA,
    tgt.IDMARCA = stg.IDMARCA,
    tgt.IDENTIDAD = stg.IDENTIDAD,
    tgt.ENVIOPRESUPUESTO = stg.ENVIOPRESUPUESTO,
    tgt.NUMTELEFONICO = stg.NUMTELEFONICO,
    tgt.MENSAJE = stg.MENSAJE,
    tgt.FRONTERIZO = stg.FRONTERIZO,
    tgt.FECHAACEPTACIONPOLITICA = stg.FECHAACEPTACIONPOLITICA,
    tgt.ESTATUSTALLER = stg.ESTATUSTALLER,
    tgt.FECACEPTACIONPOLITICAEQPESADO = stg.FECACEPTACIONPOLITICAEQPESADO,
    tgt.PAGOANTICIPADO = stg.PAGOANTICIPADO,
    tgt.USUARIOHERRAMIENTA = stg.USUARIOHERRAMIENTA,
    tgt.ACTIVARAUDACLAIMS = stg.ACTIVARAUDACLAIMS,
    tgt.COMPANIAASIGNADAACG = stg.COMPANIAASIGNADAACG,
    tgt.POOLASIGNADOACG = stg.POOLASIGNADOACG,
    tgt.USUARIOALTA = stg.USUARIOALTA,
    tgt.USUARIOACTUALIZACION = stg.USUARIOACTUALIZACION,
    tgt.ALTA = stg.ALTA,
    tgt.ACTUALIZACION = stg.ACTUALIZACION,
    tgt.IDESTADO = stg.IDESTADO,
    tgt.IMAGENQCONTENT = stg.IMAGENQCONTENT,
    tgt.ANUNCIOS_PORTAL = stg.ANUNCIOS_PORTAL,
    tgt.FECCAMPANIALIM = stg.FECCAMPANIALIM,
    tgt.RECCHATARRA = stg.RECCHATARRA,
    tgt.FECACEPTAETICACONDUCTATALLER = stg.FECACEPTAETICACONDUCTATALLER,
    tgt.FECACEPTACONFLICTOTALLER = stg.FECACEPTACONFLICTOTALLER,
    tgt.ACTIVO = stg.ACTIVO,
    tgt.MAXIMO = stg.MAXIMO,
    tgt.MINIMO = stg.MINIMO,
    tgt.RPM = stg.RPM,
    tgt.LIBERADO = stg.LIBERADO,
    tgt.FECACEPTAAPPMOVIL = stg.FECACEPTAAPPMOVIL,
    tgt.ACTIVAPROORDER = stg.ACTIVAPROORDER,
    tgt.FECACEPTAAVISOPRIV = stg.FECACEPTAAVISOPRIV,
    tgt.FECACEPTAAVISOPO = stg.FECACEPTAAVISOPO,
    tgt.IDTIPOTALLER = stg.IDTIPOTALLER,
    tgt.ACTIVAXNUUP = stg.ACTIVAXNUUP
WHEN NOT MATCHED THEN
  INSERT (
    IDTALLER,
    IDOFICINA,
    CLAVETALLER,
    RAZONSOCIAL,
    NOMBRECOMERCIAL,
    CONTRIBUYENTE,
    REPRESENTANTELEGAL,
    CORREO,
    RFC,
    DOMICILIOFISCAL,
    DIRECCIONCOMERCIAL,
    CELULARNEXTEL,
    TARIFAMOB,
    ENTIDAD,
    PERFIL,
    COTIZADOR,
    MITCHELL,
    TIPO,
    MULTIMARCA,
    IDMARCA,
    IDENTIDAD,
    ENVIOPRESUPUESTO,
    NUMTELEFONICO,
    MENSAJE,
    FRONTERIZO,
    FECHAACEPTACIONPOLITICA,
    ESTATUSTALLER,
    FECACEPTACIONPOLITICAEQPESADO,
    PAGOANTICIPADO,
    USUARIOHERRAMIENTA,
    ACTIVARAUDACLAIMS,
    COMPANIAASIGNADAACG,
    POOLASIGNADOACG,
    USUARIOALTA,
    USUARIOACTUALIZACION,
    ALTA,
    ACTUALIZACION,
    IDESTADO,
    IMAGENQCONTENT,
    ANUNCIOS_PORTAL,
    FECCAMPANIALIM,
    RECCHATARRA,
    FECACEPTAETICACONDUCTATALLER,
    FECACEPTACONFLICTOTALLER,
    ACTIVO,
    MAXIMO,
    MINIMO,
    RPM,
    LIBERADO,
    FECACEPTAAPPMOVIL,
    ACTIVAPROORDER,
    FECACEPTAAVISOPRIV,
    FECACEPTAAVISOPO,
    IDTIPOTALLER,
    ACTIVAXNUUP
  )
  VALUES (
    stg.IDTALLER,
    stg.IDOFICINA,
    stg.CLAVETALLER,
    stg.RAZONSOCIAL,
    stg.NOMBRECOMERCIAL,
    stg.CONTRIBUYENTE,
    stg.REPRESENTANTELEGAL,
    stg.CORREO,
    stg.RFC,
    stg.DOMICILIOFISCAL,
    stg.DIRECCIONCOMERCIAL,
    stg.CELULARNEXTEL,
    stg.TARIFAMOB,
    stg.ENTIDAD,
    stg.PERFIL,
    stg.COTIZADOR,
    stg.MITCHELL,
    stg.TIPO,
    stg.MULTIMARCA,
    stg.IDMARCA,
    stg.IDENTIDAD,
    stg.ENVIOPRESUPUESTO,
    stg.NUMTELEFONICO,
    stg.MENSAJE,
    stg.FRONTERIZO,
    stg.FECHAACEPTACIONPOLITICA,
    stg.ESTATUSTALLER,
    stg.FECACEPTACIONPOLITICAEQPESADO,
    stg.PAGOANTICIPADO,
    stg.USUARIOHERRAMIENTA,
    stg.ACTIVARAUDACLAIMS,
    stg.COMPANIAASIGNADAACG,
    stg.POOLASIGNADOACG,
    stg.USUARIOALTA,
    stg.USUARIOACTUALIZACION,
    stg.ALTA,
    stg.ACTUALIZACION,
    stg.IDESTADO,
    stg.IMAGENQCONTENT,
    stg.ANUNCIOS_PORTAL,
    stg.FECCAMPANIALIM,
    stg.RECCHATARRA,
    stg.FECACEPTAETICACONDUCTATALLER,
    stg.FECACEPTACONFLICTOTALLER,
    stg.ACTIVO,
    stg.MAXIMO,
    stg.MINIMO,
    stg.RPM,
    stg.LIBERADO,
    stg.FECACEPTAAPPMOVIL,
    stg.ACTIVAPROORDER,
    stg.FECACEPTAAVISOPRIV,
    stg.FECACEPTAAVISOPO,
    stg.IDTIPOTALLER,
    stg.ACTIVAXNUUP
  )