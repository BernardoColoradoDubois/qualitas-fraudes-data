MERGE INTO INSUMOS.DM_COMPLEMENTO tgt
USING RAW_INSUMOS.STG_COMPLEMENTO stg
ON (tgt.IDCOMPLEMENTO = stg.IDCOMPLEMENTO)
WHEN MATCHED THEN
  UPDATE SET
    tgt.IDEXPEDIENTE = stg.IDEXPEDIENTE,
    tgt.CODPROVEEDOR = stg.CODPROVEEDOR,
    tgt.IDREFACCION = stg.IDREFACCION,
    tgt.CONCEPTO = stg.CONCEPTO,
    tgt.FECHA = stg.FECHA,
    tgt.MONTO = stg.MONTO,
    tgt.DESCRIPCION = stg.DESCRIPCION,
    tgt.REFERENCIA = stg.REFERENCIA,
    tgt.LISTA = stg.LISTA,
    tgt.NUMPARTE = stg.NUMPARTE,
    tgt.FECHAACTUALIZACION = stg.FECHAACTUALIZACION,
    tgt.DEMERITO = stg.DEMERITO,
    tgt.OBSERVACIONES = stg.OBSERVACIONES,
    tgt.FECRECEPCION = stg.FECRECEPCION,
    tgt.COTIZADO = stg.COTIZADO,
    tgt.FECSURTIDO = stg.FECSURTIDO,
    tgt.ORIGENANTERIOR = stg.ORIGENANTERIOR,
    tgt.IDTIPOTOT = stg.IDTIPOTOT,
    tgt.ADMINREF = stg.ADMINREF,
    tgt.PIEZAPAQUETE = stg.PIEZAPAQUETE,
    tgt.MONTOCONVENIO = stg.MONTOCONVENIO,
    tgt.PORCENTAJEADQUISICION = stg.PORCENTAJEADQUISICION,
    tgt.IDTRUCKEST = stg.IDTRUCKEST,
    tgt.FECHAENVIO = stg.FECHAENVIO,
    tgt.NUMEROGUIA = stg.NUMEROGUIA,
    tgt.MENSAJERIA = stg.MENSAJERIA,
    tgt.BLOQUEOREFACCION = stg.BLOQUEOREFACCION,
    tgt.FECASIGNACIONMANUAL = stg.FECASIGNACIONMANUAL,
    tgt.FECASIGNACIONDIRECTA = stg.FECASIGNACIONDIRECTA,
    tgt.IDDEDUCIBLECOBERTURA = stg.IDDEDUCIBLECOBERTURA,
    tgt.IDDEMERITOTIPO = stg.IDDEMERITOTIPO,
    tgt.ORIGENSOLICITADO = stg.ORIGENSOLICITADO,
    tgt.PENDIENTEAUTORIZAR = stg.PENDIENTEAUTORIZAR,
    tgt.CLAVENAGS = stg.CLAVENAGS,
    tgt.BLINDAJE = stg.BLINDAJE,
    tgt.IDCAUSACAMBIOVALE = stg.IDCAUSACAMBIOVALE,
    tgt.ORIGENINICIAL = stg.ORIGENINICIAL,
    tgt.ORIGENVALUADOR = stg.ORIGENVALUADOR,
    tgt.FECHACHATARRA = stg.FECHACHATARRA,
    tgt.CANTIDAD = stg.CANTIDAD,
    tgt.MOTIVONORECCHATARRA = stg.MOTIVONORECCHATARRA,
    tgt.NUMPARTEVALUADOR = stg.NUMPARTEVALUADOR,
    tgt.ID_REF_COSTO_MEDIO = stg.ID_REF_COSTO_MEDIO,
    tgt.IDDISPONIBILIDAD = stg.IDDISPONIBILIDAD,
    tgt.IDCAUSACANCELARPIEZA = stg.IDCAUSACANCELARPIEZA,
    tgt.FECHACANCELACION = stg.FECHACANCELACION
WHEN NOT MATCHED THEN
  INSERT (
    IDCOMPLEMENTO,
    IDEXPEDIENTE,
    CODPROVEEDOR,
    IDREFACCION,
    CONCEPTO,
    FECHA,
    MONTO,
    DESCRIPCION,
    REFERENCIA,
    LISTA,
    NUMPARTE,
    FECHAACTUALIZACION,
    DEMERITO,
    OBSERVACIONES,
    FECRECEPCION,
    COTIZADO,
    FECSURTIDO,
    ORIGENANTERIOR,
    IDTIPOTOT,
    ADMINREF,
    PIEZAPAQUETE,
    MONTOCONVENIO,
    PORCENTAJEADQUISICION,
    IDTRUCKEST,
    FECHAENVIO,
    NUMEROGUIA,
    MENSAJERIA,
    BLOQUEOREFACCION,
    FECASIGNACIONMANUAL,
    FECASIGNACIONDIRECTA,
    IDDEDUCIBLECOBERTURA,
    IDDEMERITOTIPO,
    ORIGENSOLICITADO,
    PENDIENTEAUTORIZAR,
    CLAVENAGS,
    BLINDAJE,
    IDCAUSACAMBIOVALE,
    ORIGENINICIAL,
    ORIGENVALUADOR,
    FECHACHATARRA,
    CANTIDAD,
    MOTIVONORECCHATARRA,
    NUMPARTEVALUADOR,
    ID_REF_COSTO_MEDIO,
    IDDISPONIBILIDAD,
    IDCAUSACANCELARPIEZA,
    FECHACANCELACION
  )
  VALUES (
    stg.IDCOMPLEMENTO,
    stg.IDEXPEDIENTE,
    stg.CODPROVEEDOR,
    stg.IDREFACCION,
    stg.CONCEPTO,
    stg.FECHA,
    stg.MONTO,
    stg.DESCRIPCION,
    stg.REFERENCIA,
    stg.LISTA,
    stg.NUMPARTE,
    stg.FECHAACTUALIZACION,
    stg.DEMERITO,
    stg.OBSERVACIONES,
    stg.FECRECEPCION,
    stg.COTIZADO,
    stg.FECSURTIDO,
    stg.ORIGENANTERIOR,
    stg.IDTIPOTOT,
    stg.ADMINREF,
    stg.PIEZAPAQUETE,
    stg.MONTOCONVENIO,
    stg.PORCENTAJEADQUISICION,
    stg.IDTRUCKEST,
    stg.FECHAENVIO,
    stg.NUMEROGUIA,
    stg.MENSAJERIA,
    stg.BLOQUEOREFACCION,
    stg.FECASIGNACIONMANUAL,
    stg.FECASIGNACIONDIRECTA,
    stg.IDDEDUCIBLECOBERTURA,
    stg.IDDEMERITOTIPO,
    stg.ORIGENSOLICITADO,
    stg.PENDIENTEAUTORIZAR,
    stg.CLAVENAGS,
    stg.BLINDAJE,
    stg.IDCAUSACAMBIOVALE,
    stg.ORIGENINICIAL,
    stg.ORIGENVALUADOR,
    stg.FECHACHATARRA,
    stg.CANTIDAD,
    stg.MOTIVONORECCHATARRA,
    stg.NUMPARTEVALUADOR,
    stg.ID_REF_COSTO_MEDIO,
    stg.IDDISPONIBILIDAD,
    stg.IDCAUSACANCELARPIEZA,
    stg.FECHACANCELACION
  )