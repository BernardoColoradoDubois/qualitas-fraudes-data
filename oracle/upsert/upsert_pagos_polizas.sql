MERGE INTO INSUMOS.DM_PAGOS_POLIZAS tgt
USING RAW_INSUMOS.STG_PAGOS_POLIZAS stg
ON (tgt.ID = stg.ID)
WHEN MATCHED THEN
  UPDATE SET
    tgt.FECHA_VENCIMIENTO = stg.FECHA_VENCIMIENTO,
    tgt.POLIZA = stg.POLIZA,
    tgt.ENDOSO = stg.ENDOSO,
    tgt.POLIZA_ENDOSO = stg.POLIZA_ENDOSO,
    tgt.IMPORTE = stg.IMPORTE,
    tgt.REMESA = stg.REMESA,
    tgt.MARCA_IMP = stg.MARCA_IMP,
    tgt.MARCA_ANUL = stg.MARCA_ANUL,
    tgt.PRIMA_NETA = stg.PRIMA_NETA,
    tgt.DERECHO_POLIZA = stg.DERECHO_POLIZA,
    tgt.RECIBO_FIN = stg.RECIBO_FIN,
    tgt.IVA = stg.IVA,
    tgt.BONIFICACION = stg.BONIFICACION,
    tgt.BONIFICACION_RF = stg.BONIFICACION_RF,
    tgt.BONIFICACION_TEC = stg.BONIFICACION_TEC,
    tgt.PRIMA_TOTAL = stg.PRIMA_TOTAL,
    tgt.USUARIO_APLICA = stg.USUARIO_APLICA,
    tgt.FECHA_APLICACION = stg.FECHA_APLICACION,
    tgt.IMPRESION = stg.IMPRESION,
    tgt.RFC_FACTURACION = stg.RFC_FACTURACION,
    tgt.USUARIO_EMITE = stg.USUARIO_EMITE,
    tgt.STATUS = stg.STATUS,
    tgt.FECHA_PROCESO = stg.FECHA_PROCESO,
    tgt.FECHA_CARGA = stg.FECHA_CARGA
WHEN NOT MATCHED THEN
  INSERT (
    ID,
    FECHA_VENCIMIENTO,
    POLIZA,
    ENDOSO,
    POLIZA_ENDOSO,
    IMPORTE,
    REMESA,
    MARCA_IMP,
    MARCA_ANUL,
    PRIMA_NETA,
    DERECHO_POLIZA,
    RECIBO_FIN,
    IVA,
    BONIFICACION,
    BONIFICACION_RF,
    BONIFICACION_TEC,
    PRIMA_TOTAL,
    USUARIO_APLICA,
    FECHA_APLICACION,
    IMPRESION,
    RFC_FACTURACION,
    USUARIO_EMITE,
    STATUS,
    FECHA_PROCESO,
    FECHA_CARGA
  )
  VALUES (
    stg.ID,
    stg.FECHA_VENCIMIENTO,
    stg.POLIZA,
    stg.ENDOSO,
    stg.POLIZA_ENDOSO,
    stg.IMPORTE,
    stg.REMESA,
    stg.MARCA_IMP,
    stg.MARCA_ANUL,
    stg.PRIMA_NETA,
    stg.DERECHO_POLIZA,
    stg.RECIBO_FIN,
    stg.IVA,
    stg.BONIFICACION,
    stg.BONIFICACION_RF,
    stg.BONIFICACION_TEC,
    stg.PRIMA_TOTAL,
    stg.USUARIO_APLICA,
    stg.FECHA_APLICACION,
    stg.IMPRESION,
    stg.RFC_FACTURACION,
    stg.USUARIO_EMITE,
    stg.STATUS,
    stg.FECHA_PROCESO,
    stg.FECHA_CARGA
  );