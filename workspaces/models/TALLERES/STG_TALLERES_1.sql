TRUNCATE TABLE `{{task.params.DEST_PROJECT_ID}}.{{task.params.DEST_DATASET_NAME}}.{{task.params.DEST_TABLE_NAME}}`;
INSERT INTO `{{task.params.DEST_PROJECT_ID}}.{{task.params.DEST_DATASET_NAME}}.{{task.params.DEST_TABLE_NAME}}`
SELECT 
  IDTALLER,
  IDOFICINA,
  CLAVETALLER,
  RAZONSOCIAL,
  NOMBRECOMERCIAL,
  CONTRIBUYENTE,
  REPRESENTANTELEGAL,
  CORREO,
  RFC,
  DOMICILIOFISCAL,
  DIRECCIONCOMERCIAL,
  CELULARNEXTEL,
  TARIFAMOB,
  ENTIDAD,
  PERFIL,
  COTIZADOR,
  MITCHELL,
  TIPO,
  MULTIMARCA,
  IDMARCA,
  IDENTIDAD,
  ENVIOPRESUPUESTO,
  NUMTELEFONICO,
  MENSAJE,
  FRONTERIZO,
  FECHAACEPTACIONPOLITICA,
  ESTATUSTALLER,
  FECACEPTACIONPOLITICAEQPESADO,
  PAGOANTICIPADO,
  USUARIOHERRAMIENTA,
  ACTIVARAUDACLAIMS,
  COMPANIAASIGNADAACG,
  POOLASIGNADOACG,
  USUARIOALTA,
  USUARIOACTUALIZACION,
  ALTA,
  ACTUALIZACION,
  IDESTADO,
  IMAGENQCONTENT,
  ANUNCIOS_PORTAL,
  FECCAMPANIALIM,
  RECCHATARRA,
  FECACEPTAETICACONDUCTATALLER,
  FECACEPTACONFLICTOTALLER,
  ACTIVO,
  MAXIMO,
  MINIMO,
  RPM,
  LIBERADO,
  FECACEPTAAPPMOVIL,
  ACTIVAPROORDER,
  FECACEPTAAVISOPRIV,
  FECACEPTAAVISOPO,
  IDTIPOTALLER,
  ACTIVAXNUUP,
  ROW_NUMBER() OVER (PARTITION BY IDTALLER ORDER BY ACTUALIZACION DESC) AS RN
FROM `{{task.params.SOURCE_PROJECT_ID}}.{{task.params.SOURCE_DATASET_NAME}}.{{task.params.SOURCE_TABLE_NAME}}`;
