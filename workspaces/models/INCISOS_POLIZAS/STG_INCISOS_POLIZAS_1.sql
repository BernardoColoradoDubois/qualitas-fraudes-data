TRUNCATE TABLE `{{task.params.DEST_PROJECT_ID}}.{{task.params.DEST_DATASET_NAME}}.{{task.params.DEST_TABLE_NAME}}`;
INSERT INTO `{{task.params.DEST_PROJECT_ID}}.{{task.params.DEST_DATASET_NAME}}.{{task.params.DEST_TABLE_NAME}}`
SELECT
  DI,
  SUBSTRING(DI,0,2) AS SECCION,
  SUBSTRING(DI,3,10) AS POLIZA,
  SUBSTRING(DI,13,6) AS ENDOSO,
  SUBSTRING(DI,19) AS ANEXO_INCISO,
  SUBSTRING(DI,3,16) AS POLIZA_ENDOSO,
  MARCA_COMP,
  MARCA_CORTA,
  AMIS,
  SUBRAMO,
  MODELO,
  ORIGEN,
  TIPO_VEH,
  CARROCERIA,
  USO,
  SERVICIO,
  SAFE_CAST(OCUPANTES AS NUMERIC) AS OCUPANTES,
  SAFE_CAST(TONELADAS AS NUMERIC) AS TONELADAS,
  CARGA,
  TRAILES,
  URBANO,
  PLACAS,
  MOTOR,
  SERIE,
  COLOR,
  TRANSMISION,
  SAFE_CAST(CILINDROS AS NUMERIC) AS CILINDROS,
  SAFE_CAST(PUERTAS AS NUMERIC) AS PUERTAS,
  ANEXOS,
  ESTATUS,
  TIPO_COBER,
  CATEGORIA,
  TARIF_AUT,
  SAFE_CAST(VALOR_0KM  AS NUMERIC) AS VALOR_0KM,
  SAFE_CAST(SUMA_ASEG AS NUMERIC) AS SUMA_ASEG,
  SAFE_CAST(SUMA_ASEG_GM AS NUMERIC) AS SUMA_ASEG_GM,
  SAFE_CAST(SUMA_ASEG_RC AS NUMERIC) AS SUMA_ASEG_RC,
  SAFE_CAST(SUMA_ASEG_ADAP AS NUMERIC) AS SUMA_ASEG_ADAP,
  SAFE_CAST(NUM_PASAJEROS AS NUMERIC) AS NUM_PASAJEROS,
  SAFE_CAST(PRIMA_TOTAL AS NUMERIC) AS PRIMA_TOTAL,
  SAFE_CAST(PRIMA_DM AS NUMERIC) AS PRIMA_DM,
  SAFE_CAST(PRIMA_RT AS NUMERIC) AS PRIMA_RT,
  SAFE_CAST(PRIMA_RC AS NUMERIC) AS PRIMA_RC,
  SAFE_CAST(PRIMA_GM AS NUMERIC) AS PRIMA_GM,
  SAFE_CAST(PRIMA_EE AS NUMERIC) AS PRIMA_EE,
  SAFE_CAST(PRIMA_ADAP AS NUMERIC) AS PRIMA_ADAP,
  SAFE_CAST(PRIMA_RT_ADAP AS NUMERIC) AS PRIMA_RT_ADAP,
  CALC_PRORRATA,
  SAFE_CAST(DED_DM AS NUMERIC) AS DED_DM,
  SAFE_CAST(DED_RT AS NUMERIC) AS DED_RT,
  SAFE_CAST(DED_RC AS NUMERIC) AS DED_RC,
  SAFE_CAST(DED_EE AS NUMERIC) AS DED_EE,
  SAFE_CAST(DED_DM_ADAP AS NUMERIC) AS DED_DM_ADAP,
  SAFE_CAST(DED_RT_ADAP AS NUMERIC) AS DED_RT_ADAP,
  SAFE_CAST(REC_RC_TRAILER AS NUMERIC) AS REC_RC_TRAILER,
  SAFE_CAST(REC_RC_X_DANO_CARGA AS NUMERIC) AS REC_RC_X_DANO_CARGA,
  SAFE_CAST(DESC_DM_X_USO AS NUMERIC) AS DESC_DM_X_USO,
  SAFE_CAST(DESC_RT_X_USO AS NUMERIC) AS DESC_RT_X_USO,
  SAFE_CAST(DESC_RC_X_USO AS NUMERIC) AS DESC_RC_X_USO,
  SAFE_CAST(DESC_GM_X_USO AS NUMERIC) AS DESC_GM_X_USO,
  NOMBRE_CONDUCTOR,
  SAFE_CAST(SUMA_ASEG_ACC_OCUP AS NUMERIC) AS SUMA_ASEG_ACC_OCUP,
  SAFE_CAST(SUMA_ASEG_EXT_RC AS NUMERIC) AS SUMA_ASEG_EXT_RC,
  SAFE_CAST(SUMA_ASEG_GL AS NUMERIC) AS SUMA_ASEG_GL,
  SAFE_CAST(PRIMA_RCP AS NUMERIC) AS PRIMA_RCP,
  SAFE_CAST(PRIMA_EXT_RC AS NUMERIC) AS PRIMA_EXT_RC,
  SAFE_CAST(PRIMA_ACC_OCUP AS NUMERIC) AS PRIMA_ACC_OCUP,
  SAFE_CAST(PRIMA_GT AS NUMERIC) AS PRIMA_GT,
  SAFE_CAST(PRIMA_GL AS NUMERIC) AS PRIMA_GL,
  SAFE_CAST(PRIMA_SPT AS NUMERIC) AS PRIMA_SPT,
  SAFE_CAST(PRIMA_EXE_DED AS NUMERIC) AS PRIMA_EXE_DED,
  SAFE_CAST(PAQUETE_GL AS NUMERIC) AS PAQUETE_GL,
  SAFE_CAST(DESC_RP AS NUMERIC) AS DESC_RP,
  SAFE_CAST(SUMA_ASEG_RP AS NUMERIC) AS SUMA_ASEG_RP,
  SAFE_CAST(DED_RP AS NUMERIC) AS DED_RP,
  SAFE_CAST(PMA_RP AS NUMERIC) AS PMA_RP,
  SAFE_CAST(PMA_AJUSTE_INFL AS NUMERIC) AS PMA_AJUSTE_INFL,
  SAFE_CAST(SUMA_ASEG_AV AS NUMERIC) AS SUMA_ASEG_AV,
  SAFE_CAST(TASA_AV AS NUMERIC) AS TASA_AV,
  SAFE_CAST(PRIMA_EXT_TERRITORIAL AS NUMERIC) AS PRIMA_EXT_TERRITORIAL,
  SAFE_CAST(PRIMA_RC_ECOLOGICA AS NUMERIC) AS PRIMA_RC_ECOLOGICA,
  SAFE_CAST(SUMA_ASEG_RC_ECOLOGICA AS NUMERIC) AS SUMA_ASEG_RC_ECOLOGICA,
  SAFE_CAST(DIAS_DED_RC_ECOLOGICA AS NUMERIC) AS DIAS_DED_RC_ECOLOGICA,
  SAFE_CAST(DESC_DED_RC_ECOLOGICA AS NUMERIC) AS DESC_DED_RC_ECOLOGICA,
  SAFE_CAST(PRIMA_RC_LEGAL AS NUMERIC) AS PRIMA_RC_LEGAL,
  SAFE_CAST(SUMA_ASEG_RC_LEGAL AS NUMERIC) AS SUMA_ASEG_RC_LEGAL,
  SAFE_CAST(DIAS_DED_RC_LEGAL AS NUMERIC) AS DIAS_DED_RC_LEGAL,
  SAFE_CAST(DESC_DED_RC_LEGAL AS NUMERIC) AS DESC_DED_RC_LEGAL,
  SAFE_CAST(SUMA_ASEG_RCB AS NUMERIC) AS SUMA_ASEG_RCB,
  SAFE_CAST(PRIMA_RCB AS NUMERIC) AS PRIMA_RCB,
  SAFE_CAST(DIAS_DED_RCB AS NUMERIC) AS DIAS_DED_RCB,
  SAFE_CAST(SUMA_ASEG_RCP AS NUMERIC) AS SUMA_ASEG_RCP,
  SAFE_CAST(DIAS_DED_RCP AS NUMERIC) AS DIAS_DED_RCP,
  SAFE_CAST(SUMA_ASEG_RCC AS NUMERIC) AS SUMA_ASEG_RCC,
  SAFE_CAST(PRIMA_RCC AS NUMERIC) AS PRIMA_RCC,
  SAFE_CAST(DIAS_DED_RCC AS NUMERIC) AS DIAS_DED_RCC,
  SAFE_CAST(DESC_DED_RCB AS NUMERIC) AS DESC_DED_RCB,
  SAFE_CAST(DESC_DED_RCP AS NUMERIC) AS DESC_DED_RCP,
  SAFE_CAST(DESC_DED_RCC AS NUMERIC) AS DESC_DED_RCC,
  SAFE_CAST(PAQUETE_AV AS NUMERIC) AS PAQUETE_AV,
  SAFE_CAST(PRIMA_SERV_ASISTENCIA AS NUMERIC) AS PRIMA_SERV_ASISTENCIA,
  DESCRIP_CARGA,
  REPUVE,
  SAFE_CAST(DED_RC_PASAJERO AS NUMERIC) AS DED_RC_PASAJERO,
  SAFE_CAST(PRIMA_DANO_X_CARGA AS NUMERIC) AS PRIMA_DANO_X_CARGA,
  SAFE_CAST(PRIMA_ASISTENCIA_SATELITAL AS NUMERIC) AS PRIMA_ASISTENCIA_SATELITAL,
  UNIDAD_DE_SALVAMENTO,
  SERIE_ENCONTRACK,
  DATETIME(SAFE.PARSE_DATETIME('%d/%m/%y', FEC_INST_ENCONTRACK)) AS FEC_INST_ENCONTRACK,
  SAFE_CAST(SUMA_ASEG_RC_EXT AS NUMERIC) AS SUMA_ASEG_RC_EXT,
  SAFE_CAST(PRIMA_RC_EXT AS NUMERIC) AS PRIMA_RC_EXT,
  SAFE_CAST(DESC_RC_EXT AS NUMERIC) AS DESC_RC_EXT,
  SAFE_CAST(SUMA_ASEG_GM_EXT AS NUMERIC) AS SUMA_ASEG_GM_EXT,
  SAFE_CAST(PRIMA_GM_EXT AS NUMERIC) AS PRIMA_GM_EXT,
  SAFE_CAST(DESC_GM_EXT AS NUMERIC) AS DESC_GM_EXT,
  SAFE_CAST(PRIMA_EXE_DED_X_VEH_IDENT AS NUMERIC) AS PRIMA_EXE_DED_X_VEH_IDENT,
  SAFE_CAST(PRIMA_AJUSTE_VALOR_COM AS NUMERIC) AS PRIMA_AJUSTE_VALOR_COM,
  SAFE_CAST(PRIMA_GT_X_PP AS NUMERIC) AS PRIMA_GT_X_PP,
  SAFE_CAST(SUMA_ASEG_GT_X_PT AS NUMERIC) AS SUMA_ASEG_GT_X_PT,
  SAFE_CAST(SUMA_ASEG_GT_X_PP AS NUMERIC) AS SUMA_ASEG_GT_X_PP,
  SAFE_CAST(DIAS_DED_GT_PT AS NUMERIC) AS DIAS_DED_GT_PT,
  SAFE_CAST(DIAS_DED_GT_PP AS NUMERIC) AS DIAS_DED_GT_PP,
  SAFE_CAST(SUMA_ASEG_AJ_VAL_COM_X_PT AS NUMERIC) AS SUMA_ASEG_AJ_VAL_COM_X_PT,
  SAFE_CAST(PRIMA_EXTENSION_GARANTIA AS NUMERIC) AS PRIMA_EXTENSION_GARANTIA,
  SAFE_CAST(PRIMA_EXTENSION_MTTO AS NUMERIC) AS PRIMA_EXTENSION_MTTO,
  SAFE_CAST(COD_ANIO_EXT_GARANTIA AS NUMERIC) AS COD_ANIO_EXT_GARANTIA,
  SAFE_CAST(PRIMA_ADAPT_SPT AS NUMERIC) AS PRIMA_ADAPT_SPT,
  DATETIME(SAFE.PARSE_DATETIME('%d/%m/%y', FEC_PROCESO)) AS FEC_PROCESO,
  SAFE_CAST(PRIMA_EXE_DED_RT AS NUMERIC) AS PRIMA_EXE_DED_RT,
  PROV_ASIST_SAT,
  SAFE_CAST(SA_GTP_DIARIA AS NUMERIC) AS SA_GTP_DIARIA,
  SAFE_CAST(SA_RC_DANOS_AL_VEH_ARRASTRA AS NUMERIC) AS SA_RC_DANOS_AL_VEH_ARRASTRA,
  SAFE_CAST(PMA_RC_DAN_VEH_ARRASTRA AS NUMERIC) AS PMA_RC_DAN_VEH_ARRASTRA,
  SAFE_CAST(DIAS_RC_DAN_VEH_ARRASTRA AS NUMERIC) AS DIAS_RC_DAN_VEH_ARRASTRA,
  SAFE_CAST(DESC_DED_RC_DAN_VEH_ARRASTRA AS NUMERIC) AS DESC_DED_RC_DAN_VEH_ARRASTRA,
  SAFE_CAST(AUTORIZA_SOBREPASAR_SA_RC_DVA AS NUMERIC) AS AUTORIZA_SOBREPASAR_SA_RC_DVA,
  SAFE_CAST(SA_RC_EN_EUA AS NUMERIC) AS SA_RC_EN_EUA,
  SAFE_CAST(PMA_RC_EN_EUA AS NUMERIC) AS PMA_RC_EN_EUA,
  SAFE_CAST(DIAS_RC_EUA AS NUMERIC) AS DIAS_RC_EUA,
  SAFE_CAST(SA_RCP_EUA AS NUMERIC) AS SA_RCP_EUA,
  SAFE_CAST(PMA_RCP_EUA AS NUMERIC) AS PMA_RCP_EUA,
  SAFE_CAST(DIAS_RCP_EUA AS NUMERIC) AS DIAS_RCP_EUA,
  SAFE_CAST(SA_RCB_EUA AS NUMERIC) AS SA_RCB_EUA,
  SAFE_CAST(PMA_RCB_EUA AS NUMERIC) AS PMA_RCB_EUA,
  SAFE_CAST(DIAS_RCB_EUA AS NUMERIC) AS DIAS_RCB_EUA,
  SAFE_CAST(PAQUETE_RCB_EUA AS NUMERIC) AS PAQUETE_RCB_EUA,
  SAFE_CAST(NUM_ECONOMICO AS NUMERIC) AS NUM_ECONOMICO,
  SAFE_CAST(SA_AVERIA_MEC_ELEC AS NUMERIC) AS SA_AVERIA_MEC_ELEC,
  SAFE_CAST(PMA_AVERIA_MEC_ELEC AS NUMERIC) AS PMA_AVERIA_MEC_ELEC,
  SAFE_CAST(SA_AV_AVERIA_MEC_ELEC AS NUMERIC) AS SA_AV_AVERIA_MEC_ELEC,
  SAFE_CAST(PMA_AV_AVERIA_MEC_ELEC AS NUMERIC) AS PMA_AV_AVERIA_MEC_ELEC,
  SAFE_CAST(SA_AUTO_SUSTITUTO AS NUMERIC) AS SA_AUTO_SUSTITUTO,
  SAFE_CAST(PMA_AUTO_SUSTITUTO AS NUMERIC) AS PMA_AUTO_SUSTITUTO,
  SAFE_CAST(SA_LLANTAS AS NUMERIC) AS SA_LLANTAS,
  SAFE_CAST(PMA_LLANTAS AS NUMERIC) AS PMA_LLANTAS,
  SAFE_CAST(SA_RINES AS NUMERIC) AS SA_RINES,
  SAFE_CAST(DED_LLANTAS_Y_RINES AS NUMERIC) AS DED_LLANTAS_Y_RINES,
  SAFE_CAST(PMA_RINES AS NUMERIC) AS PMA_RINES,
  SAFE_CAST(GAP1 AS NUMERIC) AS GAP1,
  SAFE_CAST(SA_CB_FLEX AS NUMERIC) AS SA_CB_FLEX,
  DSCTO_COB,
  AMPARA_P2MIL_PREMIUM,
  MARCA_VEH_ALTO_RGO,
  INSP_VEH,
  DANIOS_PREEXISTENTES,
  DESC_DANOS_PREEXISTENTES,
  DATETIME(SAFE.PARSE_DATETIME('%d/%m/%y', FEC_INSP_VEH)) AS FEC_INSP_VEH,
  COND_VIG_A_NIVEL_DI,
  AMPARA_AV_REM_ENGAN,
  REGISTRO_CNSF,
  PMA_AV_REMOLQUE_ENGANC,
  QUIEN_HIZO_INSP_VEH,
  INSP_VEH_X_OFIC,
  VEH_BLINDADO,
  FACTOR_BLINDAJE,
  GAP2,
  SAFE_CAST(SA_RCP_OBLIGATORIA AS NUMERIC) AS SA_RCP_OBLIGATORIA,
  SAFE_CAST(PMA_RCP_OBLIG AS NUMERIC) AS PMA_RCP_OBLIG,
  SAFE_CAST(DIAS_DED_RCP_OBLIG AS NUMERIC) AS DIAS_DED_RCP_OBLIG,
  SAFE_CAST(SA_RCB_OBLIG AS NUMERIC) AS SA_RCB_OBLIG,
  SAFE_CAST(PMA_RCB_OBLIG AS NUMERIC) AS PMA_RCB_OBLIG,
  SAFE_CAST(DIAS_DED_RCB_OBLIG AS NUMERIC) AS DIAS_DED_RCB_OBLIG,
  SAFE_CAST(DESC_DED_RC_OBLIG AS NUMERIC) AS DESC_DED_RC_OBLIG,
  SAFE_CAST(DESC_DED_RCP_OBLIG AS NUMERIC) AS DESC_DED_RCP_OBLIG,
  PAQUETE_RC_OBLIG,
  ADICIONALES_AV,
  AV_MANIOBRAS,
  SAFE_CAST(RECARGO_AV_MANIOBRAS AS NUMERIC) AS RECARGO_AV_MANIOBRAS,
  SAFE_CAST(PMA_ANUAL_RC AS NUMERIC) AS PMA_ANUAL_RC,
  SAFE_CAST(PMA_ANUAL_RC_OBLIG AS NUMERIC) AS PMA_ANUAL_RC_OBLIG,
  SAFE_CAST(PMA_TOT_RC_OBLIG AS NUMERIC) AS PMA_TOT_RC_OBLIG,
  SAFE_CAST(SA_TOT_ANUAL_RC_OBLIG AS NUMERIC) AS SA_TOT_ANUAL_RC_OBLIG,
  BENEF_PREF_INCISO,
  SAFE_CAST(SA_SINIESTRALIDAD_CADE AS NUMERIC) AS SA_SINIESTRALIDAD_CADE,
  TIPO_OFIC_INSP_VEH,
  SAFE_CAST(CUOTA_AUT_SUST_PT AS NUMERIC) AS CUOTA_AUT_SUST_PT,
  SAFE_CAST(SUMA_ASEG_AS_PT AS NUMERIC) AS SUMA_ASEG_AS_PT,
  SAFE_CAST(PRIMA_AS_PT AS NUMERIC) AS PRIMA_AS_PT,
  AUTORIZO_CAMBIO_USO,
  AUTORIZO_CVES_DIREC_SERIE,
  MARCA_UBER_CABIFY,
  SA_VEH_AUTOS_INC_X_PT,
  CAUSA_INSP_VEH,
  SAFE_CAST(RGO_DESC_X_USO_SPT AS NUMERIC) AS RGO_DESC_X_USO_SPT,
  SAFE_CAST(SUMA_ASEG_AJINFL AS NUMERIC) AS SUMA_ASEG_AJINFL,
  SAFE_CAST(PRIMA_AV AS NUMERIC) AS PRIMA_AV,
  SAFE_CAST(DESC_DED_RCB_OBLIG AS NUMERIC) AS DESC_DED_RCB_OBLIG,
  SAFE_CAST(PMA_RCP AS NUMERIC) AS PMA_RCP,
  SAFE_CAST(PORC_DED_RP AS NUMERIC) AS PORC_DED_RP,
  CURRENT_DATE AS FECHA_CARGA
FROM `{{task.params.SOURCE_PROJECT_ID}}.{{task.params.SOURCE_DATASET_NAME}}.{{task.params.SOURCE_TABLE_NAME}}`;